<Window x:Class="AthStitcherGUI.JsonEditorWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:conv="clr-namespace:AthStitcherGUI.Converters"
    xmlns:sys="clr-namespace:System;assembly=mscorlib"
    xmlns:enums="clr-namespace:PhotoTimingDjaus.Enums;assembly=VideoEnums.Windows"
    Title="Video File Meta-Info VideoInfo Json Editor" Height="600" Width="800">
    <Window.Resources>
    <conv:BoolToBrushConverter x:Key="BoolToBrushConverter" />
    <conv:TimeFromIsFromGunFlashToVisibilityConverter x:Key="TimeFromIsFromGunFlashToVisibilityConverter" />
    <conv:TimeFromIsWallClockToVisibilityConverter x:Key="TimeFromIsWallClockToVisibilityConverter" />
            <ObjectDataProvider x:Key="VideoDetectModeValues" MethodName="GetValues" ObjectType="{x:Type sys:Enum}">
                <ObjectDataProvider.MethodParameters>
                    <x:Type TypeName="enums:VideoDetectMode" />
                </ObjectDataProvider.MethodParameters>
            </ObjectDataProvider>
            <ObjectDataProvider x:Key="TimeFromModeValues" MethodName="GetValues" ObjectType="{x:Type sys:Enum}">
                <ObjectDataProvider.MethodParameters>
                    <x:Type TypeName="enums:TimeFromMode" />
                </ObjectDataProvider.MethodParameters>
            </ObjectDataProvider>
    </Window.Resources>
    <DockPanel>
    <Menu DockPanel.Dock="Top" HorizontalAlignment="Left">
        <MenuItem Header="_File">
            <MenuItem Header="_Open" Click="MenuOpen_Click" />
            <MenuItem Header="_Save" Click="MenuSave_Click" />
            <MenuItem Header="_Cancel" Click="MenuCancel_Click" />
        </MenuItem>
        <MenuItem Header="GunTime" Visibility="{Binding VideoInfo.TimeFrom, Converter={StaticResource TimeFromIsWallClockToVisibilityConverter}}">
            <MenuItem Header="Set Gun Time" Click="MenuSetGunTime_Click" />
        </MenuItem>
    </Menu>
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="0" />
                <RowDefinition Height="Auto" />
            </Grid.RowDefinitions>
            <TreeView Visibility="Collapsed" ItemsSource="{Binding RootNodes}" Name="JsonTreeView" Margin="10" Grid.Row="0">
                <TreeView.ItemTemplate>
                    <HierarchicalDataTemplate ItemsSource="{Binding Children}">
                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                            <Border Width="5" />
                            <TextBlock Text="{Binding Key}" Width="150" Margin="0,0,10,0" VerticalAlignment="Center" TextAlignment="Left"/>
                            <TextBox Text="{Binding Value, UpdateSourceTrigger=PropertyChanged}" Width="250"
                                     Background="{Binding IsValid, Converter={StaticResource BoolToBrushConverter}}"
                                     VerticalAlignment="Center" TextAlignment="Left"/>
                        </StackPanel>
                    </HierarchicalDataTemplate>
                </TreeView.ItemTemplate>
            </TreeView>

            <!-- VideoInfo Editor Section (added, existing control unchanged) -->
            <GroupBox Header="VideoInfo Editor" Margin="10" Grid.Row="1">
                <StackPanel>
                    <StackPanel Orientation="Horizontal" Margin="0,5">
                        <TextBlock Text="RecordedFilename:" Width="140" VerticalAlignment="Center"/>
                        <TextBlock Width="250" FontWeight="Bold" Text="{Binding VideoInfo.RecordedFilename, Mode=OneWay, UpdateSourceTrigger=PropertyChanged}" />
                    </StackPanel>
                    <StackPanel Orientation="Horizontal" Margin="0,5">
                        <TextBlock Text="TimeFrom:" Width="140" VerticalAlignment="Center"/>
                        <ComboBox Width="250" SelectedItem="{Binding VideoInfo.TimeFrom, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" ItemsSource="{Binding Source={StaticResource TimeFromModeValues}}" />
                    </StackPanel>
                    <StackPanel Orientation="Horizontal" Margin="0,5" Visibility="{Binding VideoInfo.TimeFrom, Converter={StaticResource TimeFromIsFromGunFlashToVisibilityConverter}}">
                        <TextBlock Text="DetectMode:" Width="140" VerticalAlignment="Center"/>
                        <ComboBox Width="250" SelectedItem="{Binding VideoInfo.DetectMode, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" ItemsSource="{Binding Source={StaticResource VideoDetectModeValues}}" />
                    </StackPanel>
                    <StackPanel Orientation="Horizontal" Margin="0,5">
                        <TextBlock Text="VideoStart:" Width="140" VerticalAlignment="Center"/>
                        <TextBlock Width="250" Text="{Binding VideoInfo.VideoStart, StringFormat=yyyy-MM-dd HH:mm:ss.fff, Mode=OneWay, UpdateSourceTrigger=PropertyChanged}" />
                    </StackPanel>
                    <StackPanel Orientation="Horizontal" Margin="0,5" Visibility="{Binding VideoInfo.TimeFrom, Converter={StaticResource TimeFromIsWallClockToVisibilityConverter}}">
                        <TextBlock Text="GunTime:" Width="140" VerticalAlignment="Center"/>
                        <TextBlock Width="250" Text="{Binding VideoInfo.GunTime, StringFormat=yyyy-MM-dd HH:mm:ss.fff, Mode=OneWay, UpdateSourceTrigger=PropertyChanged}" />
                    </StackPanel>
                    <StackPanel Orientation="Horizontal" Margin="0,5">
                        <TextBlock Text="SelectedFilename:" Width="140" VerticalAlignment="Center"/>
                        <TextBlock Width="250" Text="{Binding VideoInfo.SelectedFilename, Mode=OneWay, UpdateSourceTrigger=PropertyChanged}" />
                    </StackPanel>
                    <StackPanel Orientation="Horizontal" Margin="0,5">
                        <TextBlock Text="RecordedVideoPath:" Width="140" VerticalAlignment="Center"/>
                        <TextBlock Width="250" Text="{Binding VideoInfo.RecordedVideoPath, Mode=OneWay, UpdateSourceTrigger=PropertyChanged}" />
                    </StackPanel>
                    <StackPanel Orientation="Horizontal" Margin="0,5">
                        <TextBlock Text="SelectedVideoPath:" Width="140" VerticalAlignment="Center"/>
                        <TextBlock Width="250" Text="{Binding VideoInfo.SelectedVideoPath, Mode=OneWay, UpdateSourceTrigger=PropertyChanged}" />
                    </StackPanel>





                </StackPanel>
            </GroupBox>
        </Grid>
    </DockPanel>
</Window>
